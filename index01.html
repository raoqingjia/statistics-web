<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>疫情专项数据统计分析</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <meta content="yes" name="apple-mobile-web-app-capable"/>
    <meta content="black" name="apple-mobile-web-app-status-bar-style"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" type="text/css" href="css/base.css"/>
    <link rel="stylesheet" type="text/css" href="css/earthEchars.css"/>
    <style>

        .banner {
            width: 100%;
            height: 15rem;
            background-image: url("img/banner.jpg");
            background-repeat: no-repeat;
            background-size: cover;
        }

        .title-wrap h1 {
            font-size: 16px;
            line-height: 40px;
            padding: 10px 0 0 0;
            font-weight: normal;
            text-align: center;
        }

        .title-wrap p {
            line-height: 34px;
            font-size: 14px;
            font-weight: normal;
            text-align: center;
        }

        .title-content {
            width: 100%;
            box-sizing: border-box;
            padding: 0 2rem 0;
        }

        .title-content dl {
            float: left;
            width: 50%;
            padding: 0 1rem;
            box-sizing: border-box;
        }

        .title-content dt {
            font-size: 14px;
            line-height: 34px;
        }

        .title-content dd {
            font-size: 12px;
            line-height: 30px;
        }

        .title-content dd span {
            float: right;
            color: #1660f6;
        }

        .title-content .phone {
            margin: 0.5rem 0;
            font-size: 14px;
        }
         i.reset{
             display: block;
             float: right;
             width: 20px;
             height: 20px;
             background-image: url("img/reset.jpg");
             background-repeat: no-repeat;
             background-size: cover;
             position: absolute;
             right: 1.3rem;
             top: 0.2rem;
             z-index: 99999;
         }

    </style>
</head>
<body>
<div class="banner"></div>
<div class="title-wrap clearflx">
    <h1>疫情专项数据统计分析</h1>
    <p>1月29日0时至1月29日24时数据一览</p>
    <div class="title-content clearflx">
        <div class="clearflx">
            <dl>
                <dt>云视讯数据统计</dt>
                <dd>新增订购数<span>337个</span></dd>
                <dd>新增成员数<span>28751个</span></dd>
                <dd>支撑医院数<span>36个</span></dd>
                <dd>支撑政府部门数<span>299个</span></dd>
            </dl>
            <dl>
                <dt>视频彩铃统计</dt>
                <dd>新增订购数<span>375个</span></dd>
                <dd>新增成员数<span>87255个</span></dd>
                <dd>支撑医院数<span>25个</span></dd>
                <dd>支撑政府部门数<span>345个</span></dd>
            </dl>
        </div>
        <p class="phone">集客大厅值班电话<span style="display: block">158 1051 1759 、182 0165 0691</span></p>
    </div>
</div>
<div style="position: relative;z-index: 1">
    <i class="reset" id="yunShiXunReset"></i>
    <div id="yunShiXunChina" style="width: 100%;height: 30rem;"></div>
</div>
<div style="margin: -3rem 0 0 0;">
  <div id="yunShiXunBarAndLine" style="width: 100%;height:30rem;"></div>
</div>
<div style="position: relative;z-index: 1">
    <i class="reset" id="caiLingReset"></i>
    <div id="caiLingChina" style="width: 100%;height: 30rem;"></div>
</div>
<div style="margin: -2rem 0 0 0;">
    <div id="caiLingBarAndLine" style="width: 100%;height:30rem;"></div>
</div>
<div id="bar" style="width: 100%;height: 350px;display: none;"></div>
</body>
<script src="js/lib/jquery-3.2.1.min.js"></script>
<script src="js/lib/echarts.min.js"></script>
<script src="js/lib/china.js"></script>
<script src="js/lib/vintage.js"></script>
<script>

    var yunShiXunMapData = [
        {name: '北京', value: 0}, {name: '天津', value: 0},
        {name: '上海', value: 0}, {name: '重庆', value: 7},
        {name: '河北', value: 3}, {name: '河南', value: 17014},
        {name: '云南', value: 13}, {name: '辽宁', value: 0},
        {name: '黑龙江', value: 0}, {name: '湖南', value: 0},
        {name: '安徽', value: 210}, {name: '山东', value: 1206},
        {name: '新疆', value: 0}, {name: '江苏', value: 2591},
        {name: '浙江', value: 0}, {name: '江西', value: 48},
        {name: '湖北', value: 210}, {name: '广西', value: 2981},
        {name: '甘肃', value: 332}, {name: '山西', value: 3},
        {name: '内蒙古', value: 790}, {name: '陕西', value: 0},
        {name: '吉林', value: 1}, {name: '福建', value: 3},
        {name: '贵州', value: 0}, {name: '广东', value: 0},
        {name: '青海', value: 0}, {name: '西藏', value: 0},
        {name: '四川', value: 3676}, {name: '宁夏', value: 0},
        {name: '海南', value: 0}, {name: '台湾', value: 0},
        {name: '香港', value: 0}, {name: '澳门', value: 0},
        {name: '南海诸岛', value: 0, itemStyle:{normal:{opacity:0,label:{show:false}}} }
    ];
    function yunShiXunMapChar(mapDate){
        var optionMap = {
            backgroundColor: '#FFFFFF',
            title: {
                text: '云视讯数据分布',
                left: '10px',
                textStyle: {
                    color: '#333',
                    fontStyle: 'normal',
                    fontWeight: 'normal',
                    fontSize: 14
                }
            },
            tooltip: {
                trigger: 'item',
                formatter:function(params){
                    var htmlStr = '<div>'+ params.name +'<br/>'+'总量：'+ params.value +'<br/>';   //获取横坐标的值
                    return htmlStr;
                }
            },
            //左侧小导航图标
            visualMap: {
                show: false,
                // x: 'left',
                // y: 'top',
                splitList: [
                    {start: 15000, end: 25000},
                    {start: 5000, end: 15000},
                    {start: 1000, end: 5000},
                    {start: 300, end: 1000},
                    {start: 1, end: 300},
                ],
                // min: 0,
                // max: 1000,
                // left: '20px',
                // top: 'bottom',
                // text: ['高','低'],           // 文本，默认为数值文本
                // calculable: true

            },
            //配置属性
            series: [{
                name: '总量',
                type: 'map',
                mapType: 'china',
                showLegendSymbol: false,   // 隐藏指示点
                roam: false,
                zoom: 1.1,
                label: {
                    position: 'left',
                    normal: {
                        show: true, //省份名称
                        textStyle: {
                            fontSize: 10
                        },
                        formatter:function (num) {
                            if(num.value>0){
                                return num.name;
                            }else {
                                return '';
                            }
                        }
                    },
                    emphasis: {
                        show: false
                    }
                },
                data: mapDate  //数据
            }]
        };
        var charMap = echarts.init(document.getElementById('yunShiXunChina'), 'vintage');
        charMap.on('click', function(params){
            let index=null
            yunShiXunProvince.forEach((name,i)=>{
                if(name==params.name){
                    index=i
                }
            });
            if(index!=null){
                console.log(index);
                var barMax=setMaxData(yunShiXunOrderData[index]);
                var lineMax=setMaxData(yunShiXunMemberData[index]);
                console.log(barMax);
                console.log(lineMax);
                yunShiXunBarAndLineChar('yunShiXunBarAndLine', [params.name], [yunShiXunOrderData[index]], [yunShiXunMemberData[index]], 0,barMax, 0,lineMax );
            }else{
                yunShiXunBarAndLineChar('yunShiXunBarAndLine', [params.name], [], [], 0, 100, 0, 100);
            }
        });
        charMap.setOption(optionMap);
    }
    var yunShiXunProvince = ['河南','四川','江苏','山东','安徽','甘肃','重庆','福建','河北','内蒙古','云南','山西','江西','湖北','广西','吉林'];
    var yunShiXunOrderData=[202,77,15,14,6,5,3,3,3,3,1,1,1,1,1,1];
    var yunShiXunMemberData=[16812,3599,2576,1192,204,327,4,0,0,787,12,2,47,209,2980,0];
    console.log(yunShiXunProvince.length);
    console.log(yunShiXunOrderData.length);
    console.log(yunShiXunMemberData.length);
    console.log("-------------");
    function yunShiXunBarAndLineChar(charId, province, dataBar, dataLine, barMin, barMax, lineMin, lineMax) {
        var optionBarAndLine = {
            backgroundColor: '#FFFFFF',
            color: ['#3398DB', '#f77003'],
            title: {
                text: '云视讯数据统计',
                left: '10px',
                textStyle: {
                    color: '#333',
                    fontStyle: 'normal',
                    fontWeight: 'normal',
                    fontSize: 14
                }
            },
            tooltip: {
                trigger: 'axis',
                // axisPointer: {
                // 	type: 'cross',
                // 	crossStyle: {
                // 		color: '#999'
                // 	}
                // }
            },
            toolbox: {
                feature: {
                    dataView: {show: false, readOnly: false},
                    magicType: {show: false, type: ['line', 'bar']},
                    restore: {show: false},
                    saveAsImage: {show: false}
                }
            },
            grid: {
                left: '4%',
                right: '4%',
                top: '5%',
                bottom: '21%',
            },
            legend: {
                data: ['订购数', '成员数'],
                right: '20px',
                top: '0%',
            },
            dataZoom: [
                {
                    show: true,
                    realtime: true,
                    start: 0,
                    end: 40,
                    // maxSpan: 20,
                    zoomLock: true,  //  只能平移不能缩放
                    textStyle: {
                        lineHeight: 20,
                        fontSize: 12
                    },
                    bottom: '0',
                }, {
                    type: 'inside',
                    zoomOnMouseWheel: false,
                    moveOnMouseMove: false,
                    realtime: true,
                    start: 0,
                    end: 20,

                }
            ],
            xAxis: [
                {
                    type: 'category',
                    data: province,
                    axisLabel: {
                        show: true,
                        interval: 0,
                        rotate: 0,
                        textStyle: {
                            color: '#333'
                        }
                    },
                    axisPointer: {
                        type: 'none'
                    },
                    axisTick: {
                        show: false
                    }

                }
            ],
            yAxis: [
                {
                    show: false,
                    type: 'value',
                    name: '订购数',
                    min: barMin,
                    max: barMax,
                    interval: 50,
                    axisLabel: {
                        formatter: '{value} 个',
                        show: false
                    },
                    axisTick: {
                        show: false
                    },
                },
                {
                    show: false,
                    type: 'value',
                    name: '成员数',
                    min: lineMin,
                    max: lineMax,
                    interval: 5,
                    axisLabel: {
                        formatter: '{value} 个',
                        show: false
                    },
                    axisTick: {
                        show: false
                    },
                }
            ],

            series: [
                {

                    name: '订购数',
                    type: 'bar',
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                position: 'top',
                                textStyle: {
                                    color: '#3398DB'
                                }
                            }
                        },
                    },
                    barWidth: '30px',
                    data: dataBar
                },
                {
                    name: '成员数',
                    type: 'line',
                    yAxisIndex: 1,
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                position: 'top',
                                textStyle: {
                                    color: '#f77003'
                                }
                            }
                        },
                    },
                    data: dataLine
                }
            ]
        };
        var barAndLineChart = echarts.init(document.getElementById(charId));
        barAndLineChart.setOption(optionBarAndLine);
    }

    yunShiXunInit();
    function yunShiXunInit(){
        yunShiXunBarAndLineChar('yunShiXunBarAndLine', yunShiXunProvince, yunShiXunOrderData, yunShiXunMemberData, 0, 300, 0, 30000);
        yunShiXunMapChar(yunShiXunMapData);
    }
    $("#yunShiXunReset").on('click',function () {
        yunShiXunInit();
    });

    // ====================================================================================================================================

    var caiLingMapData = [
        {name: '北京', value: 21}, {name: '天津', value: 168},
        {name: '上海', value: 0}, {name: '重庆', value: 0},
        {name: '河北', value: 9}, {name: '河南', value: 0},
        {name: '云南', value: 0}, {name: '辽宁', value: 0},
        {name: '黑龙江', value: 27}, {name: '湖南', value: 318},
        {name: '安徽', value: 33161}, {name: '山东', value: 11928},
        {name: '新疆', value: 0}, {name: '江苏', value: 3824},
        {name: '浙江', value: 5493}, {name: '江西', value: 1271},
        {name: '湖北', value: 5}, {name: '广西', value: 21},
        {name: '甘肃', value: 18928}, {name: '山西', value: 0},
        {name: '内蒙古', value: 4323}, {name: '陕西', value: 18},
        {name: '吉林', value: 0}, {name: '福建', value: 459},
        {name: '贵州', value: 4902}, {name: '广东', value: 1286},
        {name: '青海', value: 0}, {name: '西藏', value: 0},
        {name: '四川', value: 1468}, {name: '宁夏', value: 0},
        {name: '海南', value: 0}, {name: '台湾', value: 0},
        {name: '香港', value: 0}, {name: '澳门', value: 0},
        {name: '南海诸岛', value: 0, itemStyle:{normal:{opacity:0,label:{show:false}}} }
    ];
    function caiLingMapChar(mapDate){
        var optionMap = {
            backgroundColor: '#FFFFFF',
            title: {
                text: '云视讯数据分布',
                left: '10px',
                textStyle: {
                    color: '#333',
                    fontStyle: 'normal',
                    fontWeight: 'normal',
                    fontSize: 14
                }
            },
            tooltip: {
                trigger: 'item',
                formatter:function(params){
                     var htmlStr = '<div>'+ params.name +'<br/>'+'总量：'+ params.value +'<br/>';   //获取横坐标的值
                    return htmlStr;
                }
            },
            //左侧小导航图标
            visualMap: {
                show: false,
                // x: 'left',
                // y: 'top',
                splitList: [
                    {start: 15000, end: 25000},
                    {start: 5000, end: 15000},
                    {start: 1000, end: 5000},
                    {start: 300, end: 1000},
                    {start: 1, end: 300},
                ],
                // min: 0,
                // max: 1000,
                // left: '20px',
                // top: 'bottom',
                // text: ['高','低'],           // 文本，默认为数值文本
                // calculable: true

            },
            //配置属性
            series: [{
                name: '总量',
                type: 'map',
                mapType: 'china',
                showLegendSymbol: false,   // 隐藏指示点
                roam: false,
                zoom: 1.1,
                label: {
                    position: 'left',
                    normal: {
                        show: true, //省份名称
                        textStyle: {
                            fontSize: 10
                        },
                        formatter:function (num) {
                            if(num.value>0){
                                return num.name;
                            }else {
                                return '';
                            }
                        }
                    },
                    emphasis: {
                        show: false
                    }
                },
                data: mapDate  //数据
            }]
        };
        var charMap = echarts.init(document.getElementById('caiLingChina'), 'vintage');
        charMap.on('click', function(params){
            let index=null
            caiLingProvince.forEach((name,i)=>{
                if(name==params.name){
                    index=i
                }
            });
            if(index!=null){
                var barMax=setMaxData(caiLingOrderData[index]);
                var lineMax=setMaxData(caiLingMemberData[index]);
                console.log(barMax);
                console.log(lineMax);
                caiLingBarAndLineChar('caiLingBarAndLine', [params.name], [caiLingOrderData[index]], [caiLingMemberData[index]], 0,barMax, 0,lineMax );
            }else{
                caiLingBarAndLineChar('caiLingBarAndLine', [params.name], [], [], 0, 100, 0, 100);
            }
        });
        charMap.setOption(optionMap);
    }

    var caiLingProvince = ['甘肃','山东','江西','江苏','安徽','福建','四川','贵州','内蒙古','广东','浙江','陕西','广西' ,'河北' ,'北京' ,'天津' ,'黑龙江' ,'湖南' ,'湖北' ];
    var caiLingOrderData=[178,113,13,12,10,8,8,6,5,5,5,3,2,2,1,1,1,1,1];
    var caiLingMemberData=[18750,11815,1258,3812,33151,451,1460,4896,4318,1281,5488,15,19,7,20,167,26,317,4];
    console.log(caiLingProvince.length);
    console.log(caiLingOrderData.length);
    console.log(caiLingMemberData.length);
    console.log("-------------");
    function caiLingBarAndLineChar(charId, province, dataBar, dataLine, barMin, barMax, lineMin, lineMax) {
        var optionBarAndLine02 = {
            backgroundColor: '#FFFFFF',
            color: ['#3398DB', '#f77003'],
            title: {
                text: '视频彩铃数据统计',
                left: '10px',
                textStyle: {
                    color: '#333',
                    fontStyle: 'normal',
                    fontWeight: 'normal',
                    fontSize: 14
                }
            },
            tooltip: {
                trigger: 'axis',
                // axisPointer: {
                // 	type: 'cross',
                // 	crossStyle: {
                // 		color: '#999'
                // 	}
                // }
            },
            toolbox: {
                feature: {
                    dataView: {show: false, readOnly: false},
                    magicType: {show: false, type: ['line', 'bar']},
                    restore: {show: false},
                    saveAsImage: {show: false}
                }
            },
            grid: {
                left: '4%',
                right: '4%',
                top: '5%',
                bottom: '21%',
            },
            legend: {
                data: ['订购数', '成员数'],
                right: '20px',
                top: '0%',
            },
            dataZoom: [
                {
                    show: true,
                    realtime: true,
                    start: 0,
                    end: 40,
                    // maxSpan: 20,
                    zoomLock: true,  //  只能平移不能缩放
                    textStyle: {
                        lineHeight: 20,
                        fontSize: 12
                    },
                    bottom: '0',
                }, {
                    type: 'inside',
                    zoomOnMouseWheel: false,
                    moveOnMouseMove: false,
                    realtime: true,
                    start: 0,
                    end: 20,

                }
            ],
            xAxis: [
                {
                    type: 'category',
                    data: province,
                    axisLabel: {
                        show: true,
                        interval: 0,
                        rotate: 0,
                        textStyle: {
                            color: '#333'
                        }
                    },
                    axisPointer: {
                        type: 'none'
                    },
                    axisTick: {
                        show: false
                    }

                }
            ],
            yAxis: [
                {
                    show: false,
                    type: 'value',
                    name: '订购数',
                    min: barMin,
                    max: barMax,
                    interval: 50,
                    axisLabel: {
                        formatter: '{value} 个',
                        show: false
                    },
                    axisTick: {
                        show: false
                    },
                },
                {
                    show: false,
                    type: 'value',
                    name: '成员数',
                    min: lineMin,
                    max: lineMax,
                    interval: 5,
                    axisLabel: {
                        formatter: '{value} 个',
                        show: false
                    },
                    axisTick: {
                        show: false
                    },
                }
            ],

            series: [
                {

                    name: '订购数',
                    type: 'bar',
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                position: 'top',
                                textStyle: {
                                    color: '#3398DB'
                                }
                            }
                        },
                    },
                     barWidth: '30px',
                    data: dataBar
                },
                {
                    name: '成员数',
                    type: 'line',
                    yAxisIndex: 1,
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                position: 'top',
                                textStyle: {
                                    color: '#f77003'
                                }
                            }
                        },
                    },
                    data: dataLine
                }
            ]
        };
        var barAndLineChart = echarts.init(document.getElementById(charId));
        barAndLineChart.setOption(optionBarAndLine02);
    }

    caiLingInit();
    function caiLingInit(){
        caiLingBarAndLineChar('caiLingBarAndLine', caiLingProvince, caiLingOrderData, caiLingMemberData, 0, 300, 0, 45000);
        caiLingMapChar(caiLingMapData);
    }
    $("#caiLingReset").on('click',function () {
        caiLingInit();
    });

    // ====================================================================================================================================


   function setMaxData(data){
       console.log(data);
       var flag=0;
       if(data<=3){
           flag=5;
       } else if(data<=5){
           flag=8;
       } else  if(data<=10){
           flag=12;
       } else if(data<=20){
           flag=30;
       } else  if(data<=30){
           flag=50;
       } else if(data<=50){
            flag=100;
       } else if(data<=100){
            flag=150;
       }else if(data<=300){
           flag=500;
       }else if(data<=500){
            flag=700;
        }else if(data<=1000){
            flag=1500;
        }else if(data<=1500){
            flag=1800;
        }else if(data<=2000){
            flag=2500;
        }else if(data<=5000){
           flag=6000;
       }else if(data<=7000){
           flag=9000;
       } else if(data<=10000){
           flag=12000;
       }else if(data<=12000){
           flag=15000;
       }else if(data<=15000){
           flag=18000;
       }else if(data<=18000){
           flag=22000;
       }else if(data<=22000){
           flag=25000;
       }else if(data<=25000){
            flag=27000;
        }else if(data<=30000){
            flag=35000;
        }else if(data<=35000){
            flag=40000;
        }
         return  flag;
    }

</script>


<script>
    (function (doc, win) {
        var docEl = doc.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function () {
                var clientWidth = docEl.clientWidth;
                if (!clientWidth) return;
                docEl.style.fontSize = 10 * (clientWidth / 320) + 'px';
            };

        if (!doc.addEventListener) return;
        win.addEventListener(resizeEvt, recalc, false);
        doc.addEventListener('DOMContentLoaded', recalc, false);
        recalc();
    })(document, window);
</script>
<script>
    var optionBar = {
        color: ['#3398DB'],
        tooltip: {
            trigger: 'axis',
            axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
            }
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis: [
            {
                type: 'category',
                data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                axisTick: {
                    alignWithLabel: true
                }
            }
        ],
        yAxis: [
            {
                type: 'value'
            }
        ],
        series: [
            {
                name: '直接访问',
                type: 'bar',
                barWidth: '60%',
                data: [10, 52, 200, 334, 390, 330, 220]
            }
        ]
    };
    var barChart = echarts.init(document.getElementById('bar'));
    barChart.setOption(optionBar);
</script>

</html>
